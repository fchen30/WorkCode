import requests
import os
from bs4 import BeautifulSoup
from requests_kerberos import HTTPKerberosAuth, OPTIONAL
from selenium import webdriver
from selenium.webdriver.common.keys import Keys
from selenium.webdriver.support.ui import Select
from selenium.webdriver.support.ui import WebDriverWait
from io import StringIO
import pandas as pd

cert = r"C:\Users\chenfa\Documents\YardLog\cacerts.pem"
os.environ["REQUESTS_CA_BUNDLE"] = cert
kerberos = HTTPKerberosAuth(mutual_authentication=OPTIONAL)

#driver =webdriver.Edge(r'C:\MicrosoftWebDriver')
driver =webdriver.Chrome(r'C:\U\chromedriver')
#driver = webdriver.Firefox()
url = 'https://ipc-bm.amazon.com/inbound/inbound/view_transpose?org=US&report_id='
driver.get(url)

#driver.find_element_by_id('show_real_time_inventory_checkbox').click()
#driver.find_element_by_xpath("//input[@value ='Table']").click()
#driver.find_element_by_xpath("//input[@value ='Excel']").click()

#webscrape from webpage

html = (driver.execute_script("return document.getElementsByTagName('html')[0].innerHTML"))
soup = BeautifulSoup(html, 'lxml')
table= soup.find('table', {'class': 'table table-condensed table-hover table-report'})

for body in table('tbody'):
    body.unwrap()
    
df = pd.read_html(str(table), flavor = "bs4")
df = pd.DataFrame(df[0])
df.to_csv(r'C:\Users\bg.csv', index = False )
